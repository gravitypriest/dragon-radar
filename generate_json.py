'''
Some jank-ass code for creating demux_by_episode.json, dev use only
'''

import json

new_info = {"DBZ": {}}

with open("./params/demux.json", "r") as demuxfile:
    demux_info = json.load(demuxfile)

with open("./params/episodes.json", "r") as epfile:
    ep_info = json.load(epfile)


def r2disc(i):
    b = 1 if i < 147 else 2
    if b == 1 and i < 132:
        d = int(i / 6) + 1
        disc_eps = list(range(d * 6 - 5, d * 6 + 1))
    elif b == 1 and i >= 132:
        d = int((i - 132) / 5) + 23
        disc_eps = list(map(lambda e: e + 132, list(range((d-22) * 5 - 4, (d-22) * 5 + 1))))
    elif b == 2:
        d = int((i - 147) / 6) + 1
        disc_eps = list(map(lambda e: e + 147, list(range(d * 6 - 5, d * 6 + 1))))

    return int(b), int(d), disc_eps.index(i+1)


def r1disc(i):
    for b in ep_info["DBZ"]:
        for d in ep_info["DBZ"][b]:
            disc = ep_info["DBZ"][b][d]
            if (i + 1) in range(disc[0], disc[1] + 1):
                disc_eps = list(range(disc[0], disc[1] + 1))
                return int(b), int(d), disc_eps.index(i+1)


# S1
for i in range(0, 291):
    ep = str(i + 1).zfill(3)
    box, disc, ep_on_r1disc = r1disc(i)

    # S1 weird, already documented
    if box == 1:
        cells = demux_info["DBZ"]["1"]["pgcdemux"][ep]
        vid = list(map(lambda v: (v + 6 * ep_on_r1disc), ([2, 3, 5, 6])))
        vts = 2

    # S2 1, 9 / 1, 2, 4, 5 pattern checks out
    # S3 1, 9 / 1, 2, 4, 5 pattern checks out
    if box == 2 or box == 3:
        cells = list(map(lambda v: (v + 9 * ep_on_r1disc), [1, 9]))
        vid = list(map(lambda v: (v + 6 * ep_on_r1disc), ([1, 2, 4, 5])))
        vts = 2
    # S4 -- S4 has US audio as track 0
    # D1
    # 1, 11     /   2, 3, 5, 6, 8
    # 12, 23    /   9, 10, 12, 13, 15
    # 24, 34    /   16, 17, 19, 20, 22
    # 35, 45    /   23, 24, 26, 27, 29
    # 46, 56    /   30, 31, 33, 34, 36
    # 57, 67    /   37, 38, 40, 41, 43
    # D2, D3, D4, D5, D6
    # 1, 11     /   2, 3, 5, 6, 8
    # 12, 22    /   9, 10, 12, 13, 15
    # 23, 33    /   16, 17, 19, 20, 22
    # 34, 44    /   23, 24, 26, 27, 29
    # 45, 55    /   30, 31, 33, 34, 36
    # 56, 66    /   37, 38, 40, 41, 43
    if box == 4:
        dmx = {
            "1": {
                "cells": [[1, 11], [12, 23], [24, 34], [35, 45], [46, 56], [57, 67]],
                "vid": [[2, 3, 5, 6, 8],
                        [9, 10, 12, 13, 15],
                        [16, 17, 19, 20, 22],
                        [23, 24, 26, 27, 29],
                        [30, 31, 33, 34, 36],
                        [37, 38, 40, 41, 43]]
            },
            "2-6": {
                "cells": [[1, 11], [12, 22], [23, 33], [34, 44], [45, 55], [56, 66]],
                "vid": [[2, 3, 5, 6, 8],
                        [9, 10, 12, 13, 15],
                        [16, 17, 19, 20, 22],
                        [23, 24, 26, 27, 29],
                        [30, 31, 33, 34, 36],
                        [37, 38, 40, 41, 43]]
            }
        }
        if disc == 1:
            disckey = "1"
        else:
            disckey = "2-6"
        cells = dmx[disckey]['cells'][ep_on_r1disc]
        vid = dmx[disckey]['vid'][ep_on_r1disc]
        vts = 1

    # S5 -- S5 has US audio as track 0
    # D1, D2
    # 1, 10     /   2, 3, 5, 6
    # 11, 20    /   8, 9, 11, 12
    # 21, 30    /   14, 15, 17, 18
    # 32, 41    /   21, 22, 24, 25
    # 42, 51    /   27, 28, 30, 31
    # 52, 61    /   33, 34, 36, 37
    # D3, D4, D5, D6
    # 1, 10     /   2, 3, 5, 6
    # 11, 20    /   8, 9, 11, 12
    # 21, 30    /   14, 15, 17, 18
    # 31, 40    /   20, 21, 23, 24
    # 41, 50    /   26, 27, 29, 30
    if box == 5:
        dmx = {
            "1-2": {
                "cells": [[1, 10], [11, 20], [21, 30], [32, 41], [42, 51], [52, 61]],
                "vid": [[2, 3, 5, 6],
                        [8, 9, 11, 12],
                        [14, 15, 17, 18],
                        [21, 22, 24, 25],
                        [27, 28, 30, 31],
                        [33, 34, 36, 37]]
            },
            "3-6": {
                "cells": [[1, 10], [11, 20], [21, 30], [31, 40], [41, 50]],
                "vid": [[2, 3, 5, 6],
                        [8, 9, 11, 12],
                        [14, 15, 17, 18],
                        [20, 21, 23, 24],
                        [26, 27, 29, 30]]
            }
        }
        if disc == 1 or disc == 2:
            disckey = "1-2"
        else:
            disckey = "3-6"
        cells = dmx[disckey]['cells'][ep_on_r1disc]
        vid = dmx[disckey]['vid'][ep_on_r1disc]
        vts = 1

    # S6
    # D1, D2, D3
    # 1, 10     /   2, 3, 5, 6
    # 11, 20    /   8, 9, 11, 12
    # 21, 30    /   14, 15, 17, 18
    # 32, 41    /   21, 22, 24, 25
    # 42, 51    /   27, 28, 30, 31
    # 52, 61    /   33, 34, 36, 37
    # D4, D5, D6
    # 1, 10     /   2, 3, 5, 6
    # 11, 20    /   8, 9, 11, 12
    # 21, 30    /   14, 15, 17, 18
    # 31, 40    /   20, 21, 23, 24
    # 41, 50    /   26, 27, 29, 30
    if box == 6:
        dmx = {
            "1-3": {
                "cells": [[1, 10], [11, 20], [21, 30], [32, 41], [42, 51], [52, 61]],
                "vid": [[2, 3, 5, 6],
                        [8, 9, 11, 12],
                        [14, 15, 17, 18],
                        [21, 22, 24, 25],
                        [27, 28, 30, 31],
                        [33, 34, 36, 37]]
            },
            "4-6": {
                "cells": [[1, 10], [11, 20], [21, 30], [31, 40], [41, 50]],
                "vid": [[2, 3, 5, 6],
                        [8, 9, 11, 12],
                        [14, 15, 17, 18],
                        [20, 21, 23, 24],
                        [26, 27, 29, 30]]
            }
        }
        if disc == 1 or disc == 2 or disc == 3:
            disckey = "1-3"
        else:
            disckey = "4-6"
        cells = dmx[disckey]['cells'][ep_on_r1disc]
        vid = dmx[disckey]['vid'][ep_on_r1disc]
        vts = 1

    # S7
    # D1, D2
    # 1, 10     /   2, 3, 5, 6, 8
    # 11, 20    /   9, 10, 12, 13, 15
    # 21, 30    /   16, 17, 19, 20, 22
    # 33, 42    /   25, 26, 28, 29, 31
    # 43, 52    /   32, 33, 35, 36, 38
    # 53, 62    /   39, 40, 42, 43, 45
    # D3
    # 1, 10     /   2, 3, 5, 6, 8
    # 11, 20    /   9, 10, 12, 13, 15
    # 23, 32    /   18, 19, 21, 22, 24
    # 33, 42    /   25, 26, 28, 29, 31
    # D4, D5, D6
    # 1, 10     /   2, 3, 5, 6, 8
    # 11, 20    /   9, 10, 12, 13, 15
    # 21, 30    /   16, 17, 19, 20, 22
    if box == 7:
        dmx = {
            "1-2": {
                "cells": [[1, 10 ], [11, 20], [21, 30], [33, 42], [43, 52], [53, 62]],
                "vid": [[2, 3, 5, 6, 8],
                        [9, 10, 12, 13, 15],
                        [16, 17, 19, 20, 22],
                        [25, 26, 28, 29, 31],
                        [32, 33, 35, 36, 38],
                        [39, 40, 42, 43, 45]]
            },
            "3": {
                "cells": [[1, 10], [11, 20], [23, 32], [33, 42]],
                "vid": [[2, 3, 5, 6, 8],
                        [9, 10, 12, 13, 15],
                        [18, 19, 21, 22, 24],
                        [25, 26, 28, 29, 31]]
            },
            "4-6": {
                "cells": [[1, 10], [11, 20], [21, 30]],
                "vid": [[2, 3, 5, 6, 8],
                        [9, 10, 12, 13, 15],
                        [16, 17, 19, 20, 22]]
            }
        }
        if disc == 1 or disc == 2:
            disckey = "1-2"
        elif disc == 3:
            disckey = "3"
        else:
            disckey = "4-6"
        cells = dmx[disckey]['cells'][ep_on_r1disc]
        vid = dmx[disckey]['vid'][ep_on_r1disc]
        vts = 5

    # S8
    # D1
    # 1, 10     /   2, 3, 5, 6, 8
    # 12, 21    /   10, 11, 13, 14, 16
    # 23, 32    /   18, 19, 21, 22, 24
    # 34, 43    /   26, 27, 29, 30, 32
    # 45, 54    /   34, 35, 37, 38, 40
    # 56, 65    /   42, 43, 45, 46, 48
    # D2, D3, D4, D5, D6
    # 1, 10     /   2, 4, 5, 7
    # 12, 21    /   9, 11, 12, 14
    # 23, 32    /   16, 18, 19, 21
    # 34, 43    /   23, 25, 26, 28
    # 45, 54    /   30, 32, 33, 35
    # 56, 65    /   37, 39, 40, 42
    if box == 8:
        dmx = {
            "1": {
                "cells": [[1, 10 ], [12, 21], [23, 32], [34, 43], [45, 54], [56, 65]],
                "vid": [[2, 3, 5, 6, 8],
                        [10, 11, 13, 14, 16],
                        [18, 19, 21, 22, 24],
                        [26, 27, 29, 30, 32],
                        [34, 35, 37, 38, 40],
                        [42, 43, 45, 46, 48]]
            },
            "2-6": {
                "cells": [[1, 10], [12, 21], [23, 32], [34, 43], [45, 54], [56, 65]],
                "vid": [[2, 4, 5, 7],
                        [9, 11, 12, 14],
                        [16, 18, 19, 21],
                        [23, 25, 26, 28],
                        [30, 32, 33, 35],
                        [37, 39, 40, 42]]
            }
        }
        if disc == 1:
            disckey = "1"
        else:
            disckey = "2-6"
        cells = dmx[disckey]['cells'][ep_on_r1disc]
        vid = dmx[disckey]['vid'][ep_on_r1disc]
        vts = 5

    # S9
    # D1, D2, D3, D4, D5, D6
    # 1, 10     /   2, 4, 5, 7
    # 12, 21    /   9, 11, 12, 14
    # 23, 32    /   16, 18, 19, 21
    # 34, 43    /   23, 25, 26, 28
    # 45, 54    /   30, 32, 33, 35
    # 56, 65    /   37, 39, 40, 42
    # 67, 76    /   44, 46, 47, 49
    if box == 9:
        dmx = {
            "cells": [[1, 10 ], [12, 21], [23, 32], [34, 43], [45, 54], [56, 65], [67, 76]],
            "vid": [[2, 4, 5, 7],
                    [9, 11, 12, 14],
                    [16, 18, 19, 21],
                    [23, 25, 26, 28],
                    [30, 32, 33, 35],
                    [37, 39, 40, 42],
                    [44, 46, 47, 49]]
        }
        cells = dmx['cells'][ep_on_r1disc]
        vid = dmx['vid'][ep_on_r1disc]
        vts = 5


    r1_ep_obj = {
        "box": box,
        "type": "pgc",
        "disc": disc,
        "pgc": 1,
        "cells": cells,
        "vid": vid,
        "vts": vts
    }

    box, disc, ep_on_r2disc = r2disc(i)
    r2_ep_obj = {
        "box": box,
        "disc": disc,
        "type": "pgc",
        "pgc": ep_on_r2disc + 3,
        "vid": None,
        "cells": None,
        "vts": 1
    }

    ep_obj = {"R1": r1_ep_obj, "R2": r2_ep_obj}
    new_info["DBZ"][ep] = ep_obj

with open('new_info.json', 'w') as outfil:
    json.dump(new_info, outfil, sort_keys=True)

# S1 weird, already documented
# S2 1, 9 / 1, 2, 4, 5 pattern checks out
# S3 1, 9 / 1, 2, 4, 5 pattern checks out

# S4 -- S4 has US audio as track 0
# D1
# 1, 11     /   2, 3, 5, 6, 8
# 12, 23    /   9, 10, 12, 13, 15
# 24, 34    /   16, 17, 19, 20, 22
# 35, 45    /   23, 24, 26, 27, 29
# 46, 56    /   30, 31, 33, 34, 36
# 57, 67    /   37, 38, 40, 41, 43
# D2, D3, D4, D5, D6
# 1, 11     /   2, 3, 5, 6, 8
# 12, 22    /   9, 10, 12, 13, 15
# 23, 33    /   16, 17, 19, 20, 22
# 34, 44    /   23, 24, 26, 27, 29
# 45, 55    /   30, 31, 33, 34, 36
# 56, 66    /   37, 38, 40, 41, 43

# S5 -- S5 has US audio as track 0
# D1, D2
# 1, 10     /   2, 3, 5, 6
# 11, 20    /   8, 9, 11, 12
# 21, 30    /   14, 15, 17, 18
# 32, 41    /   21, 22, 24, 25
# 42, 51    /   27, 28, 30, 31
# 52, 61    /   33, 34, 36, 37
# D3, D4, D5, D6
# 1, 10     /   2, 3, 5, 6
# 11, 20    /   8, 9, 11, 12
# 21, 30    /   14, 15, 17, 18
# 31, 40    /   20, 21, 23, 24
# 41, 50    /   26, 27, 29, 30

# S6
# D1, D2, D3
# 1, 10     /   2, 3, 5, 6
# 11, 20    /   8, 9, 11, 12
# 21, 30    /   14, 15, 17, 18
# 32, 41    /   21, 22, 24, 25
# 42, 51    /   27, 28, 30, 31
# 52, 61    /   33, 34, 36, 37
# D4, D5, D6
# 1, 10     /   2, 3, 5, 6
# 11, 20    /   8, 9, 11, 12
# 21, 30    /   14, 15, 17, 18
# 31, 40    /   20, 21, 23, 24
# 41, 50    /   26, 27, 29, 30

# (angle 2 from now on)
# S7
# D1, D2
# 1, 10     /   2, 3, 4, 6, 7
# 11, 20    /   9, 10, 11, 13, 14
# 21, 30    /   16, 17, 18, 20, 21
# 33, 42    /   25, 26, 27, 29, 30
# 43, 52    /   32, 33, 34, 36, 37
# 53, 62    /   39, 40, 41, 43, 44
# D3
# 1, 10     /   2, 3, 4, 6, 7
# 11, 20    /   9, 10, 11, 13, 14
# 23, 32    /   18, 19, 20, 22, 23
# 33, 42    /   25, 26, 27, 29, 30
# D4, D5, D6
# 1, 10     /   2, 3, 4, 6, 7
# 11, 20    /   9, 10, 11, 13, 14
# 21, 30    /   16, 17, 18, 20, 21

# S8
# D1
# 1, 10     /   2, 3, 4, 6, 7
# 12, 21    /   10, 11, 12, 14, 15
# 23, 32    /   18, 19, 20, 22, 23
# 34, 43    /   26, 27, 28, 30, 31
# 45, 54    /   34, 35, 36, 38, 39
# 56, 65    /   42, 43, 44, 46, 47
# D2, D3, D4, D5, D6
# 1, 10     /   2, 3, 5, 6
# 12, 21    /   9, 10, 12, 13
# 23, 32    /   16, 17, 19, 20
# 34, 43    /   23, 24, 26, 27
# 45, 54    /   30, 31, 33, 34
# 56, 65    /   37, 38, 40, 41

# S9
# D1, D2, D3, D4, D5, D6
# 1, 10     /   2, 3, 5, 6
# 12, 21    /   9, 10, 12, 13
# 23, 32    /   16, 17, 19, 20
# 34, 43    /   23, 24, 26, 27
# 45, 54    /   30, 31, 33, 34
# 56, 65    /   37, 38, 40, 41
# 67, 76    /   44, 45, 47, 48


#---adjusted for angle 2---
# S7
# D1, D2
# 1, 10     /   2, 3, 5, 6, 8
# 11, 20    /   9, 10, 12, 13, 15
# 21, 30    /   16, 17, 19, 20, 22
# 33, 42    /   25, 26, 28, 29, 31
# 43, 52    /   32, 33, 35, 36, 38
# 53, 62    /   39, 40, 42, 43, 45
# D3
# 1, 10     /   2, 3, 5, 6, 8
# 11, 20    /   9, 10, 12, 13, 15
# 23, 32    /   18, 19, 21, 22, 24
# 33, 42    /   25, 26, 28, 29, 31
# D4, D5, D6
# 1, 10     /   2, 3, 5, 6, 8
# 11, 20    /   9, 10, 12, 13, 15
# 21, 30    /   16, 17, 19, 20, 22

# S8
# D1
# 1, 10     /   2, 3, 5, 6, 8
# 12, 21    /   10, 11, 13, 14, 16
# 23, 32    /   18, 19, 21, 22, 24
# 34, 43    /   26, 27, 29, 30, 32
# 45, 54    /   34, 35, 37, 38, 40
# 56, 65    /   42, 43, 45, 46, 48
# D2, D3, D4, D5, D6
# 1, 10     /   2, 4, 5, 7
# 12, 21    /   9, 11, 12, 14
# 23, 32    /   16, 18, 19, 21
# 34, 43    /   23, 25, 26, 28
# 45, 54    /   30, 32, 33, 35
# 56, 65    /   37, 39, 40, 42

# S9
# D1, D2, D3, D4, D5, D6
# 1, 10     /   2, 4, 5, 7
# 12, 21    /   9, 11, 12, 14
# 23, 32    /   16, 18, 19, 21
# 34, 43    /   23, 25, 26, 28
# 45, 54    /   30, 32, 33, 35
# 56, 65    /   37, 39, 40, 42
# 67, 76    /   44, 46, 47, 49
